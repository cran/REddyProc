<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Uncertainty aggregation</title>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Uncertainty aggregation</h1>



<div id="aggregating-uncertainty-to-daily-and-annual-values" class="section level1">
<h1>Aggregating uncertainty to daily and annual values</h1>
<div id="example-setup" class="section level2">
<h2>Example setup</h2>
<p>We start with half-hourly <span class="math inline">\(u_*\)</span>-filtered and gapfilled NEE_f values. For simplicity this example uses data provided with the package and omits <span class="math inline">\(u_*\)</span> threshold detection but rather applies a user-specified threshold.</p>
<p>With option <code>FillAll = TRUE</code>, an uncertainty, specifically the standard deviation, of the flux is estimated for each record during gapfilling and stored in variable <code>NEE_uStar_fsd</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(REddyProc)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb1-3" title="3">EddyDataWithPosix &lt;-<span class="st"> </span>Example_DETha98 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="st">  </span><span class="kw">filterLongRuns</span>(<span class="st">&quot;NEE&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="st">  </span><span class="kw">fConvertTimeToPosix</span>(<span class="st">&#39;YDH&#39;</span>,<span class="dt">Year =</span> <span class="st">&#39;Year&#39;</span>,<span class="dt">Day =</span> <span class="st">&#39;DoY&#39;</span>, <span class="dt">Hour =</span> <span class="st">&#39;Hour&#39;</span>)</a>
<a class="sourceLine" id="cb1-6" title="6">EProc &lt;-<span class="st"> </span>sEddyProc<span class="op">$</span><span class="kw">new</span>(</a>
<a class="sourceLine" id="cb1-7" title="7">  <span class="st">&#39;DE-Tha&#39;</span>, EddyDataWithPosix, <span class="kw">c</span>(<span class="st">&#39;NEE&#39;</span>,<span class="st">&#39;Rg&#39;</span>,<span class="st">&#39;Tair&#39;</span>,<span class="st">&#39;VPD&#39;</span>, <span class="st">&#39;Ustar&#39;</span>))</a>
<a class="sourceLine" id="cb1-8" title="8">EProc<span class="op">$</span><span class="kw">sMDSGapFillAfterUstar</span>(<span class="st">&#39;NEE&#39;</span>, <span class="dt">uStarTh =</span> <span class="fl">0.3</span>, <span class="dt">FillAll =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-9" title="9">results &lt;-<span class="st"> </span>EProc<span class="op">$</span><span class="kw">sExportResults</span>() </a>
<a class="sourceLine" id="cb1-10" title="10">results_good &lt;-<span class="st"> </span>results <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(NEE_uStar_fqc <span class="op">&lt;=</span><span class="st"> </span><span class="dv">1</span>) </a>
<a class="sourceLine" id="cb1-11" title="11"><span class="kw">summary</span>(results_good<span class="op">$</span>NEE_uStar_fsd)</a></code></pre></div>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
##  0.03535  1.69194  2.31331  2.70544  3.39922 17.19675</code></pre>
<p>We can inspect, how the uncertainty scales with the flux magnitude.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">results_good <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="kw">sample.int</span>(<span class="kw">nrow</span>(results_good),<span class="dv">400</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">plot</span>( NEE_uStar_fsd <span class="op">~</span><span class="st"> </span>NEE_uStar_fall, <span class="dt">data =</span> . )</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="omitting-problematic-records" class="section level2">
<h2>Omitting problematic records</h2>
<p>REddyProc flags filled data with poor gap-filling by a quality flag in <code>NEE_&lt;uStar&gt;_fqc</code> &gt; 0 but still reports the fluxes. For aggregation we recommend computing the mean including those gap-filled records, i.e. using <code>NEE_&lt;uStar&gt;_f</code> instead of <code>NEE_orig</code>. However, for estimating the uncertainty of the aggregated value, the the gap-filled records should not contribute to the reduction of uncertainty due to more replicates.</p>
<p>Hence, first we create a column similar <code>NEE_orig_sd</code> to <code>NEE_&lt;uStar&gt;_fsd</code> but where the estimated uncertainty is set to missing for the gap-filled records.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">results &lt;-<span class="st"> </span>EProc<span class="op">$</span><span class="kw">sExportResults</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb4-3" title="3">    <span class="dt">NEE_orig_sd =</span> <span class="kw">ifelse</span>(</a>
<a class="sourceLine" id="cb4-4" title="4">      <span class="kw">is.finite</span>(.data<span class="op">$</span>NEE_uStar_orig), .data<span class="op">$</span>NEE_uStar_fsd, <span class="ot">NA</span>),</a>
<a class="sourceLine" id="cb4-5" title="5">    <span class="dt">NEE_uStar_fgood =</span> <span class="kw">ifelse</span>(</a>
<a class="sourceLine" id="cb4-6" title="6">      <span class="kw">is.finite</span>(.data<span class="op">$</span>NEE_uStar_fqc <span class="op">&lt;=</span><span class="st"> </span><span class="dv">1</span>), .data<span class="op">$</span>NEE_uStar_f, <span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb4-7" title="7">)</a></code></pre></div>
<p>If the aggregated mean should be computed excluding poor quality-gap-filled data, then its best to use a column with values set to missing for poor quality, e.g. using <code>NEE_&lt;uStar&gt;_fgood</code> instead of <code>NEE_&lt;uStar&gt;_f</code>. However, the bias in aggregated results can be larger when omitting records, e.g. consistently omitting more low night-time fluxes, than with using poor estimates of those fluxes.</p>
</div>
<div id="random-error" class="section level2">
<h2>Random error</h2>
<p>For a given u* threshold, the aggregation across time uses many records. The random error in each record, i.e. <code>NEE_fsd</code>, is only partially correlated to the random error to records close by. Hence, the relative uncertainty of the aggregated value decreases compared to the average relative uncertainty of the individual observations.</p>
<div id="wrong-aggregation-without-correlations" class="section level3">
<h3>Wrong aggregation without correlations</h3>
<p>With neglecting correlations among records, the uncertainty of the mean annual flux is computed by adding the variances. The mean is computed by <span class="math inline">\(m = \sum{x_i}/n\)</span>. And hence its standard deviation by <span class="math inline">\(sd(m) = \sqrt{Var(m)}= \sqrt{\sum{Var(x_i)}/n^2} = \sqrt{n \bar{\sigma^2}/n^2} = \bar{\sigma^2}/\sqrt{n}\)</span>. This results in an approximate reduction of the average standard deviation <span class="math inline">\(\bar{\sigma^2}\)</span> by <span class="math inline">\(\sqrt{n}\)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">results <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(</a>
<a class="sourceLine" id="cb5-2" title="2">  <span class="dt">nRec =</span> <span class="kw">sum</span>(<span class="kw">is.finite</span>(NEE_orig_sd))</a>
<a class="sourceLine" id="cb5-3" title="3">  , <span class="dt">NEEagg =</span> <span class="kw">mean</span>(NEE_uStar_f)</a>
<a class="sourceLine" id="cb5-4" title="4">  , <span class="dt">varSum =</span> <span class="kw">sum</span>(NEE_orig_sd<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb5-5" title="5">  , <span class="dt">seMean =</span> <span class="kw">sqrt</span>(varSum) <span class="op">/</span><span class="st"> </span>nRec</a>
<a class="sourceLine" id="cb5-6" title="6">  , <span class="dt">seMeanApprox =</span> <span class="kw">mean</span>(NEE_orig_sd, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(nRec)</a>
<a class="sourceLine" id="cb5-7" title="7">  ) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(NEEagg, nRec, seMean, seMeanApprox)</a></code></pre></div>
<pre><code>##      NEEagg  nRec     seMean seMeanApprox
## 1 -1.657303 10901 0.02988839   0.02650074</code></pre>
<p>Due to the large number of records, the estimated uncertainty is very low.</p>
</div>
<div id="considering-correlations" class="section level3">
<h3>Considering correlations</h3>
<p>When observations are not independent of each other, the formulas now become <span class="math inline">\(Var(m) = s^2/n_{eff}\)</span> where <span class="math inline">\(s^2 = \frac{n_{eff}}{n(n_{eff}-1)} \sum_{i=1}^n \sigma_i^2\)</span>, and with the number of effective observations <span class="math inline">\(n_{eff}\)</span> decreasing with the autocorrelation among records (Bayley 1946, Zieba 2011).</p>
<p>The average standard deviation <span class="math inline">\(\sqrt{\bar{\sigma^2_i}}\)</span> now approximately decreases only by about <span class="math inline">\(\sqrt{n_{eff}}\)</span>:</p>
<p><span class="math display">\[
Var(m) = \frac{s^2}{n_{eff}} 
= \frac{\frac{n_{eff}}{n(n_{eff}-1)} \sum_{i=1}^n \sigma_i^2}{n_{eff}}
= \frac{1}{n(n_{eff}-1)} \sum_{i=1}^n \sigma_i^2 \\
= \frac{1}{n(n_{eff}-1)} n \bar{\sigma^2_i} = \frac{\bar{\sigma^2_i}}{(n_{eff}-1)} 
\]</span></p>
<p>First we need to quantify the error terms, i.e. model-data residuals. For all the records of good quality, we have an original measured value <code>NEE_uStar_orig</code> and modelled value from MDS gapfilling, <code>NEE_uStar_fall</code>.</p>
<p>For computing autocorrelation, equidistant time steps are important. Hence, instead of filtering, the residuals of bad-quality data are set to missing.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">results &lt;-<span class="st"> </span>EProc<span class="op">$</span><span class="kw">sExportResults</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb7-3" title="3">    <span class="dt">resid =</span> <span class="kw">ifelse</span>(NEE_uStar_fqc <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, NEE_uStar_orig <span class="op">-</span><span class="st"> </span>NEE_uStar_fall, <span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb7-4" title="4">    ,<span class="dt">NEE_orig_sd =</span> <span class="kw">ifelse</span>(</a>
<a class="sourceLine" id="cb7-5" title="5">      <span class="kw">is.finite</span>(.data<span class="op">$</span>NEE_uStar_orig), .data<span class="op">$</span>NEE_uStar_fsd, <span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb7-6" title="6">  )</a></code></pre></div>
<p>Now we can inspect the the autocorrelation of the errors.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">acf</span>(results<span class="op">$</span>resid, <span class="dt">na.action =</span> na.pass, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The empirical autocorrelation function shows strong positive autocorrelation in residuals up to a lag of 10 records.</p>
<p>Computation of effective number of observations is provided by function <code>computeEffectiveNumObs</code> from package <code>lognorm</code> based on the empirical autocorrelation function for given model-data residuals. Note that this function needs to be applied to the series including all records, i.e.  not filtering quality flag before.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">autoCorr &lt;-<span class="st"> </span>lognorm<span class="op">::</span><span class="kw">computeEffectiveAutoCorr</span>(results<span class="op">$</span>resid)</a>
<a class="sourceLine" id="cb9-2" title="2">nEff &lt;-<span class="st"> </span>lognorm<span class="op">::</span><span class="kw">computeEffectiveNumObs</span>(results<span class="op">$</span>resid, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb9-3" title="3"><span class="kw">c</span>(<span class="dt">nEff =</span> nEff, <span class="dt">nObs =</span> <span class="kw">sum</span>(<span class="kw">is.finite</span>(results<span class="op">$</span>resid)))</a></code></pre></div>
<pre><code>##      nEff      nObs 
##  4230.522 10901.000</code></pre>
<p>We see that the effective number of observations is only about a third of the number of observations.</p>
<p>Now we can use the formulas for the sum and the mean of correlated normally distributed variables to compute the uncertainty of the mean.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">resRand &lt;-<span class="st"> </span>results <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(</a>
<a class="sourceLine" id="cb11-2" title="2">  <span class="dt">nRec =</span> <span class="kw">sum</span>(<span class="kw">is.finite</span>(NEE_orig_sd))</a>
<a class="sourceLine" id="cb11-3" title="3">  , <span class="dt">NEEagg =</span> <span class="kw">mean</span>(NEE_uStar_f, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb11-4" title="4">  , <span class="dt">varMean =</span> <span class="kw">sum</span>(NEE_orig_sd<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span>nRec <span class="op">/</span><span class="st"> </span>(<span class="op">!!</span>nEff <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb11-5" title="5">  , <span class="dt">seMean =</span> <span class="kw">sqrt</span>(varMean) </a>
<a class="sourceLine" id="cb11-6" title="6">  <span class="co">#, seMean2 = sqrt(mean(NEE_orig_sd^2, na.rm = TRUE)) / sqrt(!!nEff - 1)</span></a>
<a class="sourceLine" id="cb11-7" title="7">  , <span class="dt">seMeanApprox =</span> <span class="kw">mean</span>(NEE_orig_sd, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="op">!!</span>nEff <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb11-8" title="8">  ) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(NEEagg, seMean, seMeanApprox)</a>
<a class="sourceLine" id="cb11-9" title="9">resRand</a></code></pre></div>
<pre><code>##      NEEagg     seMean seMeanApprox
## 1 -1.657303 0.04798329   0.04254471</code></pre>
<p>The aggregated value is the same, but its uncertainty increased compared to the computation neglecting correlations.</p>
<p>Note, how we used <code>NEE_uStar_f</code> for computing the mean, but <code>NEE_orig_sd</code> instead of <code>NEE_uStar_fsd</code> for computing the uncertainty.</p>
</div>
<div id="daily-aggregation" class="section level3">
<h3>Daily aggregation</h3>
<p>When aggregating daily respiration, the same principles hold.</p>
<p>However, when computing the number of effective observations, we recommend using the empirical autocorrelation function estimated on longer time series of residuals (<code>autoCorr</code> computed above) in <code>computeEffectiveNumObs</code> instead of estimating them from the residuals of each day.</p>
<p>First, create a column DoY to subset records of each day.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">results &lt;-<span class="st"> </span>results <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb13-2" title="2">  <span class="dt">DateTime =</span> EddyDataWithPosix<span class="op">$</span>DateTime     <span class="co"># take time stamp form input data</span></a>
<a class="sourceLine" id="cb13-3" title="3">  , <span class="dt">DoY =</span> <span class="kw">as.POSIXlt</span>(DateTime <span class="op">-</span><span class="st"> </span><span class="dv">15</span><span class="op">*</span><span class="dv">60</span>)<span class="op">$</span>yday <span class="co"># midnight belongs to the previous</span></a>
<a class="sourceLine" id="cb13-4" title="4">)</a></code></pre></div>
<p>Now the aggregation can be done on data grouped by DoY. The notation <code>!!</code> tells <code>summarise</code> to use the variable <code>autoCorr</code> instead of a column with that name.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">aggDay &lt;-<span class="st"> </span>results <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(DoY) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="st">  </span><span class="kw">summarise</span>(</a>
<a class="sourceLine" id="cb14-4" title="4">    <span class="dt">DateTime =</span> <span class="kw">first</span>(DateTime)</a>
<a class="sourceLine" id="cb14-5" title="5">    ,<span class="dt">nEff =</span> lognorm<span class="op">::</span><span class="kw">computeEffectiveNumObs</span>(</a>
<a class="sourceLine" id="cb14-6" title="6">       resid, <span class="dt">effAcf =</span> <span class="op">!!</span>autoCorr, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-7" title="7">    , <span class="dt">nRec =</span> <span class="kw">sum</span>(<span class="kw">is.finite</span>(NEE_orig_sd))</a>
<a class="sourceLine" id="cb14-8" title="8">    , <span class="dt">NEE =</span> <span class="kw">mean</span>(NEE_uStar_f, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-9" title="9">    , <span class="dt">sdNEE =</span> <span class="cf">if</span> (nEff <span class="op">&lt;=</span><span class="st"> </span><span class="dv">1</span>) <span class="ot">NA_real_</span> <span class="cf">else</span> <span class="kw">sqrt</span>(</a>
<a class="sourceLine" id="cb14-10" title="10">      <span class="kw">mean</span>(NEE_orig_sd<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span>(nEff <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)) </a>
<a class="sourceLine" id="cb14-11" title="11">    , <span class="dt">sdNEEuncorr =</span> <span class="cf">if</span> (nRec <span class="op">&lt;=</span><span class="st"> </span><span class="dv">1</span>) <span class="ot">NA_real_</span> <span class="cf">else</span> <span class="kw">sqrt</span>(</a>
<a class="sourceLine" id="cb14-12" title="12">       <span class="kw">mean</span>(NEE_orig_sd<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span>(nRec <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb14-13" title="13">    , <span class="dt">.groups =</span> <span class="st">&quot;drop_last&quot;</span></a>
<a class="sourceLine" id="cb14-14" title="14">  )</a>
<a class="sourceLine" id="cb14-15" title="15">aggDay</a></code></pre></div>
<pre><code>## # A tibble: 365 × 7
##      DoY DateTime             nEff  nRec      NEE  sdNEE sdNEEuncorr
##    &lt;int&gt; &lt;dttm&gt;              &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;
##  1     0 1998-01-01 00:30:00 11.0     21  0.124    0.760       0.536
##  2     1 1998-01-02 00:30:00  3.66     7  0.00610  1.56        1.04 
##  3     2 1998-01-03 00:30:00  0        0  0.0484  NA          NA    
##  4     3 1998-01-04 00:30:00  0        0  0.303   NA          NA    
##  5     4 1998-01-05 00:30:00 10.9     28  0.195    0.861       0.521
##  6     5 1998-01-06 00:30:00 18.0     48  0.926    0.615       0.370
##  7     6 1998-01-07 00:30:00 18.0     48 -0.337    0.566       0.340
##  8     7 1998-01-08 00:30:00 17.7     46 -0.139    0.525       0.320
##  9     8 1998-01-09 00:30:00 17.5     45  0.614    0.474       0.290
## 10     9 1998-01-10 00:30:00 15.4     36  0.242    0.641       0.411
## # … with 355 more rows</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The confidence bounds (+-1.96 stdDev) computed with accounting for correlations in this case are about twice the ones computed with neglecting correlations.</p>
</div>
</div>
<div id="u-threshold-uncertainty" class="section level2">
<h2>u* threshold uncertainty</h2>
<p>There is also flux uncertainty due to uncertainty in u* threshold estimation. Since the same threshold is used for all times in a given uStar scenario, the relative uncertainty of this component does not decrease when aggregating across time.</p>
<p>The strategy is to</p>
<p>1. estimate distribution of u* threshold</p>
<p>2. compute time series of NEE (or other values of interest) for draws from this distribution, i.e. for many uStar-scenarios</p>
<p>3. compute each associated aggregated value</p>
<p>4. and then look at the distribution of the aggregated values.</p>
<p>Note that the entire processing down to the aggregated value has to be repeated for each uStar scenario. Hence, obtaining a good estimate of this uncertainty is computationally expensive.</p>
<p>1. First, we estimate many samples of the probability density of the unknown uStar threshold.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="co"># for run-time of the vignette creation, here we use only few (3) uStar quantiles </span></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="co"># For real-world applications, a larger sample (&gt; 30) is required.</span></a>
<a class="sourceLine" id="cb16-3" title="3">nScen &lt;-<span class="st"> </span><span class="dv">3</span> <span class="co"># nScen &lt;- 39</span></a>
<a class="sourceLine" id="cb16-4" title="4"></a>
<a class="sourceLine" id="cb16-5" title="5">EddyDataWithPosix &lt;-<span class="st"> </span>Example_DETha98 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-6" title="6"><span class="st">  </span><span class="kw">filterLongRuns</span>(<span class="st">&quot;NEE&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-7" title="7"><span class="st">  </span><span class="kw">fConvertTimeToPosix</span>(<span class="st">&#39;YDH&#39;</span>,<span class="dt">Year =</span> <span class="st">&#39;Year&#39;</span>,<span class="dt">Day =</span> <span class="st">&#39;DoY&#39;</span>, <span class="dt">Hour =</span> <span class="st">&#39;Hour&#39;</span>)</a>
<a class="sourceLine" id="cb16-8" title="8">EProc &lt;-<span class="st"> </span>sEddyProc<span class="op">$</span><span class="kw">new</span>(</a>
<a class="sourceLine" id="cb16-9" title="9">  <span class="st">&#39;DE-Tha&#39;</span>, EddyDataWithPosix, <span class="kw">c</span>(<span class="st">&#39;NEE&#39;</span>,<span class="st">&#39;Rg&#39;</span>,<span class="st">&#39;Tair&#39;</span>,<span class="st">&#39;VPD&#39;</span>, <span class="st">&#39;Ustar&#39;</span>))</a>
<a class="sourceLine" id="cb16-10" title="10">EProc<span class="op">$</span><span class="kw">sEstimateUstarScenarios</span>( </a>
<a class="sourceLine" id="cb16-11" title="11">  <span class="dt">nSample =</span> nScen<span class="op">*</span><span class="dv">4</span>, <span class="dt">probs =</span> <span class="kw">seq</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>,<span class="dt">length.out =</span> nScen) )</a>
<a class="sourceLine" id="cb16-12" title="12">uStarSuffixes &lt;-<span class="st"> </span><span class="kw">colnames</span>(EProc<span class="op">$</span><span class="kw">sGetUstarScenarios</span>())[<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb16-13" title="13">uStarSuffixes <span class="co"># in real world should use &gt; 30</span></a></code></pre></div>
<pre><code>## [1] &quot;uStar&quot; &quot;U2.5&quot;  &quot;U50&quot;   &quot;U97.5&quot;</code></pre>
<p>2. Produce time series of gapfilled NEE for each scenario. They are stored in columns distinguished by a suffix with the quantile.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">EProc<span class="op">$</span><span class="kw">sMDSGapFillUStarScens</span>(<span class="st">&#39;NEE&#39;</span>)</a></code></pre></div>
<p>3. Compute the annual mean for each scenario. Method <code>sEddyProc_sApplyUStarScen</code> calls a user-provided function that takes an argument suffix for each u*-threshold scenario. Here, we use it to create the corresponding NEE column name and compute mean across this column in the data exported from REddyProc.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">computeMeanNEE &lt;-<span class="st"> </span><span class="cf">function</span>(ds, suffix){</a>
<a class="sourceLine" id="cb19-2" title="2">  column_name &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;NEE_&quot;</span>,suffix,<span class="st">&quot;_f&quot;</span>)</a>
<a class="sourceLine" id="cb19-3" title="3">  <span class="kw">mean</span>(ds[[column_name]])</a>
<a class="sourceLine" id="cb19-4" title="4">}</a>
<a class="sourceLine" id="cb19-5" title="5">FilledEddyData &lt;-<span class="st"> </span>EProc<span class="op">$</span><span class="kw">sExportResults</span>()</a>
<a class="sourceLine" id="cb19-6" title="6">NEEagg &lt;-<span class="st"> </span><span class="kw">unlist</span>(EProc<span class="op">$</span><span class="kw">sApplyUStarScen</span>(computeMeanNEE, FilledEddyData))</a>
<a class="sourceLine" id="cb19-7" title="7">NEEagg</a></code></pre></div>
<pre><code>##     uStar      U2.5       U50     U97.5 
## -1.616926 -1.631296 -1.629745 -1.697455</code></pre>
<p>4. compute uncertainty across aggregated values</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">sdNEEagg_ustar &lt;-<span class="st"> </span><span class="kw">sd</span>(NEEagg)</a>
<a class="sourceLine" id="cb21-2" title="2">sdNEEagg_ustar</a></code></pre></div>
<pre><code>## [1] 0.03630883</code></pre>
</div>
<div id="combined-aggregated-uncertainty" class="section level2">
<h2>Combined aggregated uncertainty</h2>
<p>Assuming that the uncertainty due to unknown u*threshold is independent from the random uncertainty, the variances add.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">sdAnnual &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb23-2" title="2">  <span class="dt">sdRand =</span> resRand<span class="op">$</span>seMean,</a>
<a class="sourceLine" id="cb23-3" title="3">  <span class="dt">sdUstar =</span> sdNEEagg_ustar,</a>
<a class="sourceLine" id="cb23-4" title="4">  <span class="dt">sdComb =</span> <span class="kw">sqrt</span>(resRand<span class="op">$</span>seMean<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>sdNEEagg_ustar<span class="op">^</span><span class="dv">2</span>) </a>
<a class="sourceLine" id="cb23-5" title="5">)</a>
<a class="sourceLine" id="cb23-6" title="6">sdAnnual</a></code></pre></div>
<pre><code>##       sdRand    sdUstar     sdComb
## 1 0.04798329 0.03630883 0.06017248</code></pre>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
