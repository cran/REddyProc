<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">



<title></title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>







<div id="reddyproc-typical-workflow" class="section level1">
<h1>REddyProc typical workflow</h1>
<div id="importing-the-half-hourly-data" class="section level2">
<h2>Importing the half-hourly data</h2>
<p>The workflow starts with importing the half-hourly data. The example, reads a text file with data of the year 1998 from the Tharandt site and converts the separate decimal columns year, day, and hour to a POSIX timestamp column. Next, it initializes the <code>sEddyProc</code> class.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#+++ load libraries used in this vignette</span>
<span class="kw">library</span>(REddyProc)
<span class="kw">library</span>(dplyr)
<span class="co">#+++ Load data with 1 header and 1 unit row from (tab-delimited) text file</span>
fileName &lt;-<span class="st"> </span><span class="kw">getExamplePath</span>(<span class="st">'Example_DETha98.txt'</span>, <span class="dt">isTryDownload =</span> <span class="ot">TRUE</span>)
EddyData &lt;-<span class="st"> </span><span class="cf">if</span> (<span class="kw">length</span>(fileName)) <span class="kw">fLoadTXTIntoDataframe</span>(fileName) <span class="cf">else</span>
  <span class="co"># or use example dataset in RData format provided with REddyProc</span>
  Example_DETha98
<span class="co">#+++ Replace long runs of equal NEE values by NA</span>
EddyData &lt;-<span class="st"> </span><span class="kw">filterLongRuns</span>(EddyData, <span class="st">&quot;NEE&quot;</span>)
<span class="co">#+++ Add time stamp in POSIX time format</span>
EddyDataWithPosix &lt;-<span class="st"> </span><span class="kw">fConvertTimeToPosix</span>(
  EddyData, <span class="st">'YDH'</span>,<span class="dt">Year =</span> <span class="st">'Year'</span>,<span class="dt">Day =</span> <span class="st">'DoY'</span>, <span class="dt">Hour =</span> <span class="st">'Hour'</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filterLongRuns</span>(<span class="st">&quot;NEE&quot;</span>)
<span class="co">#+++ Initalize R5 reference class sEddyProc for post-processing of eddy data</span>
<span class="co">#+++ with the variables needed for post-processing later</span>
EProc &lt;-<span class="st"> </span>sEddyProc<span class="op">$</span><span class="kw">new</span>(
  <span class="st">'DE-Tha'</span>, EddyDataWithPosix, <span class="kw">c</span>(<span class="st">'NEE'</span>,<span class="st">'Rg'</span>,<span class="st">'Tair'</span>,<span class="st">'VPD'</span>, <span class="st">'Ustar'</span>))</code></pre></div>
<p>A fingerprint-plot of the source half-hourly shows already several gaps. A fingerprint-plot is a color-coded image of the half-hourly fluxes by daytime on the x and and day of the year on the y axis.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">EProc<span class="op">$</span><span class="kw">sPlotFingerprintY</span>(<span class="st">'NEE'</span>, <span class="dt">Year =</span> <span class="dv">1998</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>For writing plots of data of several years to pdf see also</p>
<ul>
<li><a href="../html/sEddyProc_sPlotFingerprint.html"><code>sEddyProc_sPlotFingerprint</code></a>,</li>
<li><a href="../html/sEddyProc_sPlotHHFluxes.html"><code>sEddyProc_sPlotHHFluxes</code></a>, and</li>
<li><a href="../html/sEddyProc_sPlotDiurnalCycle.html"><code>sEddyProc_sPlotDiurnalCycle</code></a>.</li>
</ul>
</div>
<div id="estimating-the-ustar-threshold-distribution" class="section level2">
<h2>Estimating the uStar threshold distribution</h2>
<p>The second step, is the estimation of the distribution of uStar thresholds, to identify periods of low friction velocity (uStar), where NEE is biased low. Discarding periods with low uStar is one of the largest sources of uncertainty in aggregated fluxes. Hence, several quantiles of the distribution of the uncertain uStar threshold are estimated by a bootstrap.</p>
<p>The friction velocity, uStar, needs to be in column named “Ustar” of the input dataset.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">EProc<span class="op">$</span><span class="kw">sEstimateUstarScenarios</span>(
    <span class="dt">nSample =</span> 100L, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.95</span>))
EProc<span class="op">$</span><span class="kw">sGetEstimatedUstarThresholdDistribution</span>()</code></pre></div>
<pre><code>##   aggregationMode seasonYear  season     uStar        5%       50%
## 1          single         NA    &lt;NA&gt; 0.4162500 0.3733788 0.4539167
## 2            year       1998    &lt;NA&gt; 0.4162500 0.3733788 0.4539167
## 3          season       1998 1998001 0.4162500 0.3733788 0.4539167
## 4          season       1998 1998003 0.4162500 0.3239083 0.4028770
## 5          season       1998 1998006 0.3520000 0.3147500 0.3800000
## 6          season       1998 1998009 0.3369231 0.2414849 0.3899733
## 7          season       1998 1998012 0.1740000 0.2918839 0.4380000
##         95%
## 1 0.5960938
## 2 0.5960938
## 3 0.5960938
## 4 0.5119187
## 5 0.4516000
## 6 0.5271833
## 7 0.5960938</code></pre>
<p>The output reports annually aggregated uStar estimates of 0.42 for the original data and 0.37, 0.45, 0.6 for lower, median, and upper quantile of the estimated distribution. The threshold can vary between periods of different surface roughness, e.g. before and after harvest. Therefore, there are estimates for different time periods, called seasons. These season-estimates are by default aggregated to entire years.</p>
<p>The subsequent post processing steps will be repeated using the four <span class="math inline">\(u_*\)</span> threshold scenarios (non-resampled and tree quantiles of the bootstrapped distribution). They require to specify a <span class="math inline">\(u_*\)</span>-threshold for each season and a suffix to distinguish the outputs related to different thresholds. By default the annually aggregated estimates are used for each season within the year.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">EProc<span class="op">$</span><span class="kw">sGetUstarScenarios</span>()</code></pre></div>
<pre><code>##    season   uStar       U05       U50       U95
## 1 1998001 0.41625 0.3733788 0.4539167 0.5960938
## 2 1998003 0.41625 0.3733788 0.4539167 0.5960938
## 3 1998006 0.41625 0.3733788 0.4539167 0.5960938
## 4 1998009 0.41625 0.3733788 0.4539167 0.5960938
## 5 1998012 0.41625 0.3733788 0.4539167 0.5960938</code></pre>
</div>
<div id="gap-filling" class="section level2">
<h2>Gap-filling</h2>
<p>The second post-processing step is filling the gaps in NEE using information of the valid data. Here, we decide to use the same annual <span class="math inline">\(u_*\)</span> threshold estimate in each season, as obtained above, and decide to compute uncertainty also for valid records (FillAll).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">EProc<span class="op">$</span><span class="kw">sMDSGapFillUStarScens</span>(<span class="st">'NEE'</span>)</code></pre></div>
<p>The screen output (not shown here) already shows that the <span class="math inline">\(u_*\)</span>-filtering and gap-filling was repeated for each given estimate of the <span class="math inline">\(u_*\)</span> threshold , i.e. column in <code>uStarThAnnual</code>, with marking 22% to 38% of the data as gap. For gap-filling without prior <span class="math inline">\(u_*\)</span>-filtering using <code>sEddyProc_sMDSGapFill</code> or for applying single or user-specified <span class="math inline">\(u_*\)</span> thresholds using <code>sEddyProc_sMDSGapFillAfterUstar</code> see <code>vignette(&quot;uStarCases&quot;)</code>.</p>
<p>For each of the different <span class="math inline">\(u_*\)</span> threshold estimates a separate set of output columns of filled NEE and its uncertainty is generated, distinguished by the suffixes given with <code>uStarSuffixes</code>. <Suffix>“_f&quot; denotes the filled value and “_fsd&quot; the estimated standard deviation of its uncertainty.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;NEE_.*_f$&quot;</span>,<span class="kw">names</span>(EProc<span class="op">$</span><span class="kw">sExportResults</span>()), <span class="dt">value =</span> <span class="ot">TRUE</span>)
<span class="kw">grep</span>(<span class="st">&quot;NEE_.*_fsd$&quot;</span>,<span class="kw">names</span>(EProc<span class="op">$</span><span class="kw">sExportResults</span>()), <span class="dt">value =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] &quot;NEE_uStar_f&quot; &quot;NEE_U05_f&quot;   &quot;NEE_U50_f&quot;   &quot;NEE_U95_f&quot;  
## [1] &quot;NEE_uStar_fsd&quot; &quot;NEE_U05_fsd&quot;   &quot;NEE_U50_fsd&quot;   &quot;NEE_U95_fsd&quot;</code></pre>
<p>A fingerprint-plot of one of the new variables shows that gaps have been filled.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">EProc<span class="op">$</span><span class="kw">sPlotFingerprintY</span>(<span class="st">'NEE_U50_f'</span>, <span class="dt">Year =</span> <span class="dv">1998</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABKVBMVEUAAAAAADoAAGYAAJMAAKgAAL0AANIAAOcAAPwAAP8AEv8AJv8AOpAAOv8AO/8AUP8AZf8AZrYAZv8Aef8Ajv8Ao/8AuP8Azf8A4v8A9/8M//Eh/902/8g6AAA6AP86kNs6kP9L/7Nf/55mAABmAP9mtv90/4mJ/3SQOgCQOv+QZv+Q2/+UANOUANuUAOGUOumUZvGe/1+nANOnAOGnkPez/0u2ZgC2Zv+2/9u2//+5ANO5ANu5tv/I/zbLOtPL2//SAADbkDrbkP/b///cZtPc///d/yHnAADukNvu///x/wz8AAD/EgD/JgD/OwD/UAD/ZQD/eQD/jgD/owD/tmb/tuH/tv//uAD/zQD/25D/2+n/2///4gD/9wD//7b//9v///H///f///9bur2gAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAcLUlEQVR4nO1dDZvcRHqckA+wucOAjVmMc4d9hx3CJscSLwSHJYnxbfbm8mGb2N5wu4nZ//8j0iVVTZd6WuqZXUszNl3PY49Go9W0Su93v62ZnVUMYrbpAWw7KkEFVIIKqAQVUAkqoBJUQCWogEpQAZWgAipBBVSCCqgEFVAJKqASVEAlqIBKUAGVoAIqQQVUggqoBBVQCSqgElRAJaiASlABlaACKkEFVIIK2C6Cvpr94nu8/t/fzGazT89ym+0B02GrCPqK1/+/v5kB73U3/+evm803vpl0TFtEUENAQ9BXsz/7HOLyabIZ/v/v2ezXk45qewj610Y+QFCQmvcavt7zzUBT+LDdMSG2iaA3/rHhAHz8uqHpF9/bZiVIQkKCwps3vrFNiFijYp9OOqztIejsTAS1UhL+f+Mb22yM0GxqE7SVBDWWGXQEVmyz8fKT+/mtJIgOHazEzVbPGns9JbaSoCb6ee8r6Vu72ZqjIE3TBkLbSRBg/qrZrAQtCJLTCtbHNgNL4f9A07RGaBsJgi+Xv1reDCxNia0kqDHNJMI2m7zsZ52sbiMqQQVUggqoBBVQCSqgElRAJaiASlABlaACKkEFVIIKqAQVUAkqoBJUQCWogEpQAZWgAipBBVSCCqgEFVAJKqASVEAlqIBKUAGVoAJeBkGzVxMTEjSfnxCnEYcEtufL4Ke+6yBinzhYRnJa7OLfp9/Et/8VYEfpyCkJiuPSQHjpulZekYjJcKXL39vb2zfste/3kt38IzHC++GnfxIQb8OhfZU2pyVoYCDJrkND8paQmJjIpBKUJ3o9TKtiGdwN8KvISBA3pZCUN/yhSc++EWP82WlPM1qMXeHA9NMNSdDiy5fMyjwrI8kRLh8kJCGIajU34cJbWb3nAWQBu0RQv/RshqALw/Uqb5y1nZea9TAlQScn7rLsFifi4kfhPV0fdkFGuNuPSCxVxouZw8SmZI2Q07CjjwOmJuhCdzJrb11kHj9+7Exc8MsWmJag5I7P6doTizzwNvFP0iOTjcTW6ijbJRq1y/5I56KFmpqgpZBNFyGTmRhoYyZjwlPYUVLI5Gu4yy0W7bfxnjL7iqmYXBcvCrv/PQCvwZmtcJL+oxKzJEanVzE3iGYv3KLOl4IBvZWRPuyGRtx2IYBsUEQUpDMY0DfZN29JHAQM3t5ELRLcCUDQIwUisIsKg9gR3kcUhE2FkJnzJREA/jC5Q1MTNEjOejDrbgZWF5Zoy7nwihEE6REjPwSYm0mUUfrUc71rYxsJ6hEAVwm6d1egoGnSErCBbaNxGNBN2ceT7l9tI0EDMAfu1h0I14hkKxGoAnhkaqQthJ/ei5nXOY3j8d02cicmSVat6DNPimYKCBIaLUdJAp/EhYp07HoVJIieeicAtghycrPFhwFQj48D6OOU4LOMssLph4/aCoJ6VCLxw56n3MniLjFQIkrOl4hx4hGnJqixmk1lxssxfAvIyBoSzqRefAErtwOw28qtGTt0ui62SoIKIBt3u7gVADXD642AwBNetAu8haPO+50LbIYgicy8DWCNiQNz8ZI3aocuGwYnsADpuWkIbGAXPgWdONqEyQpJEl+dnt8mkfMBbYwgIdEheg68aPS0ITIf5rb2CGUgJEgWip/KZosJm3PKDCJj9abOxc5jBphlSacoQdIlvMUrzZEbbRJzIUxbDxKSyUO/Y6etBOkoHqkUNImDqEeN8oQX2WtwZ1OKd80WZQbQdRibJygZqo8tWqbFLrIhfcK1Wgz0UQAss6SIAoVd2OYfidUBGgy6PRsh6KQfA0POSE+4bIiLNI4EeaCDj+n6+k97TLMkq2f2+3HA1ARFxyG16PoRuS4Jk30kGwSRoQ3CC4LrG8RHLW7SwVngaOWhNMwyufVgLMTq+FbUDTZjg1YDxojrDZvQlJvGyoctxBfYYAyEt8o+aIfW/d4Opp0XcwvDG4b2AYnLcQvXOtYMaWBuSVTC1X8QAJLAF3aFFxC0w1c6OcVBOC8E4jiG8/pGSo3LLD9F1jdtquEDsbEN3EAezXrGIoSmWu0QVwOoXhCZ6wG3IlTl6bF2rONnPsLNm95Iy+lmhtxjt5OAeK+VKMVBAEiyMoeViNTiYCbOxZjhsxfKkruzFTbIpShzBZaLKdVoE63G40O9IDL0/BKZpDxk0ihLbAPAt0GfjqOSbyKSHtCkXpgwQeCtvkrrtIDV0CzwOTiIzS08n3HV59jMEG5zHITdrJRJegCIjNlrGGvGRPzk1l3TLfJlUkQ//lxiYwMwJdQgtl2CmMN65w+v13uDTBHtrZuj83z3yAS9uL+7u/u7P9g5gKjnCTJCJTaYYihJtUARIvNuwLWA6y2UajBoZFnorrt7SpBJj4sMtW50FXv6d/8c/j9q/uc5eqjpheobjJEtXP6I8Y/SDMZBuCBonI4ML6oayRblvwkREvhipOQYi6Cfvvu2eX0YZWhtgqRizM/BCGQE4hI28QImHgWQIJDzkYHlaaZlHlHLkw1jTAl68U+t6Dz9+98vzjFgopcglWDVWbUgvGXso2QVAG9vvfVWkrveauuMadS1HsaWoCOToHXGpVwTJDFkVsCDaOfKlSt/GUDJ2aENuhygSghAoyVTzqZoCadL0/QEnT3dBUNHu9/Gc3QNNKfYsYmRJ5INqErMYipEBjnFBy3AgFy8tI/ARzdbC63qK7/t5CQmXpuVoMaHEdSyWRue6gZyABnPqqugiz+kWsmLMdIBE7j8ZFbVlPAWzTgLsndYPHONI1mgT2MzcsZ188vnWCf8UBEIFxjkAdYYeiSxoYH21J3UgTf5doZEHi0l8gHZPexOhW+QoOg4dPP6hR0fWYaqcuudKE02m6HpVCvI3mQpUZVX5ShrqdeYKtYo2e/+8PBeiaAe964oGNdqOQXEBjISjDTMkUodAGNFGWgGQPJ3qtWGU/5HgCwf5UQxo40PbI5a7giBYvBgL+5HhtbyYiAJQsAAzyfBEDozFwMjeEuXJRbAFz66ESF56w94em7ceG7+XuPijywO6peZ5eG6ObdiGYQBkkSvj02w8XZAcPFyarBWlCu1hAjMNnB6LBBj0npKKVIyctLa7TFr0i/uf9sQlA8UB4wPyVEqiusNsgDZuEbgukNUKI+PV0gRCYLkvBNwu52r58sNJfer3qTJJMhTDaD9VkUly6nPcYxXFmoWeGJ3wm1LOcSXgp/AEa3TFRD1bvseBysMZ0V2HU0fN1kNBHUCxfYbLWQTCxIoedq2IrZnXSxM6heejLKVdEy5uCRFEVMxj54zkTR36ZORyx2WzK9upD1e4Ti9emoRobz+7TZd82YP0ii7bedy/ea2vBjOM5UEZc6xKkGqjO134dMYQXlgpGF/pHW0Pwwjr9FESRE1Gx0YKOdfmyKovUtc99c3hcHIVwEeRKb14V4Gu8lUVnkYPmJZH38o3pifeCcRw2ZJj/nNRLDwgunnkQj68ct7yFfPp2KABXaHNDhyWYxyZKDp9Xf49l2CQaOESdOxgbP0lgxjHIJ+/PLbNp9vNtYiiO0qnEz26UFm8Y1/omuHP5dvD7vAANhQkdEq/R8yoWOCv/qdGoegh1/gP4RAzdY6BDHN8HKY1TLEhknP9S4gMpI126XKEcvULiMbIKhJMH76Dtw87UTSPjkHPF/Gadv7ISmiAMj+MKf4uJ0M2pFzs20RZZVrzeAzJurJOFSX7o5lHBVDGN2y1CEokiOiGBL5OE+i/TG/rqBHfaymbaIgmqJrYsPyMIHlaVGQuVEmW6NF0g1Brfk5WrdozyKZKhd0X7hcdSCyIn+dcbLJiORMH4WgWnOJkkaGkM4IvziNWEcNFGF5mhmfVs86BGXUysEYSN1ScZqnaQZCIuFdUwEw1EYWZ+5vM3wWqwwlb9HNZ744c7OwexyCQp7x4j5k52HUsNUlSKmGBIJG2ov2rde6KmKwK/CkmqMoZTqro5iLQThXGkqDkeKgp82k6o9fLs2sDg6GuZckSLUvFn8gG0aUBEl+yvJWdRBFIy+BumOmLTMAVMgoTRKqKSPpOPlrBXI4D+i7TWpC9TWfjgtj8Ud80QxDHv48ACr2VwHhBedQUkI3CK6gl7cjNJukb4ykLECtm7pHsSjOTMKUXGrah6oltwVG2ljxqkXR16zcKnkzVpTWWp+Mi0133mkCFVuPIL+BDBS17ELJFwM8vFUoGKCeTpvdMH9+28r6cvckR/kYmAkJ18BN26ps/rSNEmUvlLC2RnkxJchZVg+fP4iwfP86DbRyOrDC3FW3hIV7CtETG8smCFouHyagXnmqwTlUFTGuRCgrNZcl+ZJjs6Z7W76RqthxNM4CNW7qJs4CPa0NooqpVEo3rYBHvp3TPjRH78JIv/nmmyCHM40fclKeFZQG/xlg85LF4UwuQXESXjJ8Etsp9RrI0RwzLp8qlkQ3V2mYk8xU9Cm8pGWSNNKFqUlv+wiKKpaJXEEOWn14e5PVYDJHqpK104md5YWMKpO8QpmumqjaWL2zfIbe/gdLDGm3x4uk8+eIbQmZOE3GkVeg3iBbbMm2lyucBHsrADKGnheIDrUO4gfB4pSsxIVphhbJuxlmggrpFm+8f1MTtNzmlvGw7fCeez7GpEtOHEpkiqOOKR6l2IBzPZrV0Byb9YGYrosvGWkOcbxkNX+OxeqjRXOLSbWVGDSroZLHSVvHxzXK1QepcQ8Gkx7+SBNg2s0ygIcM4ZYom5ckxdLLD/RgT9q9k0fSjx4NRKw2ZAWK6itkzV3RzcftShYZaJtnvkI1024eLIGinEkScXqyktpG2zX1mtXB8gJ9sgI7TeyEy8blwuAoF+P0KTZpki6HTQiVAkYrEeEtCGIK4zo+XHqZmqAnT9QRIPlNBrTXLrz5twA8eOuPARYuK+kCUYEURYQKfChQskM0YDL0tNk3OEOrdiHpVMAjAt0xjyOmnRdbAafxeaS6knCNln99wNhRYqI6B2c1vCbNI/TWKrDqZTByHucxrQRJsp8sAwLF1FGyJc8/bx+wxHm/Q04LyqGpHmSxo0rV7GQEEwqNrJUYAsoWGEm2BhIGsccwfHoJwt2SuITh4S7Jk9E64BOt72JtWhG0wmZKjloWGSJ5HZ+CpU8VSceEvnGQVCsXGZPmqb1YMZsnUUpW5XmsHqR+aborn0ZlOOSFEXp8Jb00S2q8X61daKuSVRppFcs0hREsMlhQwkpGvI0DUTU7iEChjmr/9m2rKTGF3Sv0U23IzccncvjE03F3me2889Ctu5xEdGfE5T2aQ1SkQ/WCqLzJzD7wpLzVmqhU+cgQk5HozRjpARx2n58lSbLiIKv1ly0fw7IEkqKSq3s0gtqnfscVBjOxBLUVO4tWn1tYhF00zN4pZbmUHBEuP5xHMZAmO9hq/g7FhgG2c0aC0p7yfNAqx7E1EkR/PqeBVpc91YOTGzuWlR6wD0RUnnQfA0d2pa4i/SQ+nBwuizEGPL5uXoKtCBRBkLz/cevFXM1Y1oGFUUDM1EyiwoRCyQinna90Jec2pVEuvhy0jilBL+7vfpHsmkXV0iuB6F6LKjh5rg4PSpMCHqYZb4fNvwhgh/21GF9fh4G2J8CAQpCs9S1UV4pcrolzMiN9tLu7e893MFmFqCRF8sRIe4crKxc+3WMVWAmU7VYuxmKjJEe2jRIkNcuIzJQq1uVoOJNX8MOyjndsWosPPoKqBf3RU0xAJ8Nm75RiaV8zZ3KDBL6mrGITRNJHcbnYipE0XbvqhdbfI/kgG4oILxNBiBTlyH7vtEtdYI5wJD9mD8N+DysTuvmngZ1vz376jh0MmUjaiNFkTBSkRVjJqEZSZNmH0jOGze8QNsXI6tpiITQpdDe/IRuEPvKWGTWZzR49AilIoDPLr83Vw0r5uoPYQtYkqpfbeitYYD/nVeavPslqc64yYFxvd9f8QP5mCeN6Me8Abs/R/WYilWrWgRQLMejRjJel7+bemxyWU/Wa9jloJ9i0WEGJ70l8FrK+Men7nVDF0nP0LqTTbhpq1qEXyRevTVkWwEwenEGgrGVIlSMwTFumZnKGDTLSNphNqZit6D1bdLm6i8jYRy6FkvfRqrAAqpZWz928GZ+HE2dS5b2usI6mSqLcoa3QzDBju8btUTxrHrlw9EW3kTwyMXDHLIuXRY69LTfVmEjrpIjQuqp9TZC5diUl+9m1vRloonU8G3Tv7ClWHK77YAGmGepyZUxks+073HS+8J45q2YcqVs4yp6Us38Ql4VnxNjGMbYEoRP4x3/4ffOvn6DT+KgjkyDe6UUdmWZEDoldZnj7tiGolXRJi1loltRlxphKkXQ6BW0225RvzBWHeH7HMkFuHzlEPjNi8eR0a1nhNUtk5IwIdZZRZGTZr8ZeITk2eUVmHT2eK7l/o3oxrOZ9eC9pJB+IfwwqT9yIkJtXzfB6bP+V5plJkiLejs++tdX1OPWp3Zp8QK1kZDw3//ALeDLvkwYG7Q/JUqlDVTJaYc7JX2aFXlmpOIv9rzuaRmX5UdP1NEO69B8iZH9s+md0CcqcYzDnST5RLQhkhetTffVKtDRKNWB/KEGUGm9tVdlEzKyUpDqmnfbRt2YiVrORBxZN01C7B6P70oyqLp2zhDLlPEpBokq3LJR5F4XZajm34/j8lVEI+um7pUe/nK36cBNbM4+hUgJUUVRjC9XKJw9br3VdU2Q0UfJiVvXPiLA5DfdveB1HgjKZWB9BGoj5Fjk02aL97sNN+Kp6o6pHxoLE5kbbcK+jaKcLd0gSTozn5rvlxF6C8kK0mN2ge5aKsdz6AWe65OS4S/ZasSMLSCKH/GXc/ABGtEEP3YWtQ5BJzmIhc/u4pB313LGVQ2r2UVsMUolaoREnC0USI2ndg+HbM66KEUe79uCF9R6w5F6M6iWrzBlp7wxmsK1lPYoR4uzPAgfLv8X2PHbjJbzh7che7Mcv1zXSHJdLD7OEHXPmyaaKjYSO/jg+s1yG2rpck29122OfjkkQnJkHiiuxc9I2b6r9iwUv2VklrWxrgLa9E2fglWIoqmbOL/Wi5vi3scCSDsLqveMR1Fak/RxRjJP8Qi4ryvyiV1o5FINi6RSDHZOaHTYBWab2sdkfq+e7HjGEllCZYI0dST/cXZ44XBaX/ewD59U4pYDxVvzBEW8boi+X8lj6r7lTgsVF/WwtNhWskySLs3XUuBJ0lDiw9hzxl1mUL/ZDdoiQB7MCkPo6FT6zFoRr1KIWZhw2o7qXRIekYSA/nDKSbhXIKRiOSHQ/WWFODLW68mSWrL6q1hfWGW0p1N5h98k7ZUyZi6X+dQgSeM1K7HfX2VHFtEk1U/lQ8bbN8bsSHXZ/KZlM9HA2bYfZegTplXdc9hvLvm62a3dk2cEIZzRkklj80QyQjszEQcPYVglKiLI+qj2LHZWiWXomkmKBbE8GnyZqewnq/mS5DcLN0mk3F7Ng2Bft0KJolpATYfLnVhKySqIeV5phwb5c8996O/16sZ7xZT6SHzZtU8xnu0wZ/Q+TS1dslXGW5hISO4Rdm1WxjF3M8MYZIEU3lAm93Y82XIFTsktzYplbU8ZmjHRGzRI4XxZnKxWdd398lqwcJiB9EqrkG5Ps1Au98zbYn3rV8/JvZR3HB9enH83jj4YcxudZSAe6LKgn1ncZkkxmPUxvpNcHRUT+yWy1fBTTDo+B6O/cUG89Qd3fU6Zk+1pa7pbk2DClT4qoedmyMBYA+BJDhkSvmAQl1iDlLNllpsRdfQKKjeJsC50Ll887k8nBNO8x9ZLM1hjqGfLz1qrs7cWf+DL6ErNpocwhYx/rK4dQ4ShpntmfxFqJ94SkLZCgVSRauM3r5dWAmBPW0ihJmu2ywsghjxSiKVoQtc4YNkRQMsw0dTSYWXJ3RYgcRdJ34y+tmdFxl6dzLgeJmSBM0rxZCcpLt3PFbQmCdUqpT1rFRjYDqbaBkse8TWN1vXg9Xlp8lfvBV8P0BGUGkYFL0GF3jS9r+Z660817Eyf9u3YZSVoVIv4NqqPZHZqWICs6HPBaxYhu8UFsARMjy35uTq+vOMj67BzzGB/ID6yNaSNpv04y4lPi3JWWrjL29SA2yBghFkb6I+/+JSCR3eQrvMiYDGIzKoaLw2uSanC3PpVQmYG2aNoJuhPhju0gztCK2ZPOL7rKHknbLA7SmDbjxQyrC7tf7+Fi9sHTMi/8MK2Vig2c93Qwcd7WOCi5Ai+ckSy8mD9XPSiVyOQ+ZG7L8/irLO4i5q2abTNByfVpOw2Q4/X6LoaV6wlpBltDUI/KcZd8MCRInpvFRf386mHsdrBzvVIEAeuOjwZ7haMOlyPy5arA+hiNIE0eLk0cnguHw2CUk7HbFyJnVIIeLk0+X4SgDE5pu630+lIYSTDmWo1lgjI3f/0hl/9q7dMPHDnmWo1lgjIDkiCsflE45KBdzYS3Gaf2MjFeE2fa/XI2a1VBF8ZrtRxs8ZPvXSFAj5Asi542NO9U1w6Z1+mt0g5qnp9vHvMcG4xOL7JP284hmLbRbNDT3VSEMjYoCVSYIpxabItXdhElosdPFnNjNi+mkqsVy+yW5CSSsILS+CrW1/5yLug6bV5MYqLuHy7XBVALYsqxwrm79GkuV1xNO6vh95NCsXqgIh2gPiltl7iEFzw6z6d9ViNoGNNG0mYJ5rOYSDdZMy2DPk2GaSQ1pnNhdxomZm0zg7L5GXcnf5x/W/h4ykW93XmxpERtFOit2EDKaLa2mYyJBgevs1au1EY2i/PzDZs8Nb99lshs+Bi1Wi0Sw41ry7XjEpRZ1LvWjVt+6y5r1tYbVdeYtaVX2aBZ5K4RKCOIfHmlzG5c8zbeuDGXQ+UW9UZxaYSgeyNX42uhYt1yq6lYQ1DXO26liuUW9b6aGImgzKLe1xovY1Hva42Xsaj3tcbLiINea1SCCliPoEUitryi5XXFeSUoU/V4PXFuFTv6mVjpcxP0tBI0iBf3q4oN4Wj3ZxInVjdfQiWogEpQAZWgAipBBVSCCqgEFVAJKqASVEAlqIBKUAGVoAIuTNCzS5cufT50wNe//L7vowfhbz/t+/BPv/oGL5+FYz4pjoIHD55Q8DMODI64KEHPAjvPhhh6dql3DA+av+27oN9ewjV/Fo55cOn90jDag4dPSPgZBwYnXJSgz3Avvh64gN/2j+Gz9/v/FoL5DSQDl/ugufx+8ODBEwqdMw4MTrggQcULePDLvz0PQc8uffIsnnRQRO3gVQjyMw4NTrgwQZ83X9dHUPi8X82HNcJO+nVBgnTwSioWzzg4OOGCBLV3ov8OBw0cGMOggY8EPStbaR5c9BidMw4PjhiXoAfh+/vHgNv4p1/1XfyCoGdlG82Dh0/oR79fHJwwqoo1n/aOoWC/dNIV5IcHr2bRdcbhwS0wqpFGWHKpNzQpSB8JerAKP+3BJX1fjOqT8uAWGN3NlySo18DL7q5ic12C+j1Gi84ZtyBQvJgNWsWiLA5eyQZ1Px+foEZSz5tqfD2URjTXLD0ouSaKzeAJW3TPOAFBrzsqQQVUggqoBBVQCSqgElRAJaiASlABlaACKkEFVIIKqAQVUAkqoBJUQCWogEpQAZWgAipBBVSCCqgEFVAJKqASVEAlqIBKUAGVoAIqQQVUggqoBBVQCSqgElRAJaiASlAB/w+NTPHQJDsFAQAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
<div id="partitioning-net-flux-into-gpp-and-reco" class="section level2">
<h2>Partitioning net flux into GPP and Reco</h2>
<p>The third post-processing step is partitioning the net flux (NEE) into its gross components GPP and Reco. The partitioning needs to distinguish carefully between night-time and day-time. Therefore it needs a specification of geographical coordinates and time zone to allow computing sunrise and sunset. Further, the missing values in the used meteorological data need to be filled.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">EProc<span class="op">$</span><span class="kw">sSetLocationInfo</span>(<span class="dt">LatDeg =</span> <span class="fl">51.0</span>, <span class="dt">LongDeg =</span> <span class="fl">13.6</span>, <span class="dt">TimeZoneHour =</span> <span class="dv">1</span>)  
EProc<span class="op">$</span><span class="kw">sMDSGapFill</span>(<span class="st">'Tair'</span>, <span class="dt">FillAll =</span> <span class="ot">FALSE</span>,  <span class="dt">minNWarnRunLength =</span> <span class="ot">NA</span>)     
EProc<span class="op">$</span><span class="kw">sMDSGapFill</span>(<span class="st">'VPD'</span>, <span class="dt">FillAll =</span> <span class="ot">FALSE</span>,  <span class="dt">minNWarnRunLength =</span> <span class="ot">NA</span>)     </code></pre></div>
<p>Now we are ready to invoke the partitioning, here by the night-time approach, for each of the several filled NEE columns.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">EProc<span class="op">$</span><span class="kw">sMRFluxPartitionUStarScens</span>()</code></pre></div>
<p>The results are stored in columns <code>Reco</code> and <code>GPP_f</code> modified by the respective <span class="math inline">\(u_*\)</span> threshold suffix.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grep</span>(<span class="st">&quot;GPP.*_f$|Reco&quot;</span>,<span class="kw">names</span>(EProc<span class="op">$</span><span class="kw">sExportResults</span>()), <span class="dt">value =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] &quot;Reco_uStar&quot;  &quot;GPP_uStar_f&quot; &quot;Reco_U05&quot;    &quot;GPP_U05_f&quot;   &quot;Reco_U50&quot;   
## [6] &quot;GPP_U50_f&quot;   &quot;Reco_U95&quot;    &quot;GPP_U95_f&quot;</code></pre>
<p>Visualizations of the results by a fingerprint plot gives a compact overview.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">EProc<span class="op">$</span><span class="kw">sPlotFingerprintY</span>(<span class="st">'GPP_U50_f'</span>, <span class="dt">Year =</span> <span class="dv">1998</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>For using daytime-based flux partitioning see <a href="../html/sEddyProc_sGLFluxPartition.html"><code>sEddyProc_sGLFluxPartition</code></a> computing columns <code>GPP_DT</code> and <code>Recco_DT</code>.</p>
</div>
<div id="estimating-the-uncertainty-of-aggregated-results" class="section level2">
<h2>Estimating the uncertainty of aggregated results</h2>
<p>The results of the different <span class="math inline">\(u_*\)</span> threshold scenarios can be used for estimating the uncertainty due to not knowing the threshold.</p>
<p>First, the mean of the GPP across all the year is computed for each <span class="math inline">\(u_*\)</span>-scenario and converted from <span class="math inline">\({\mu mol\, CO_2\, m^{-2} s^{-1}}\)</span> to <span class="math inline">\({gC\,m^{-2} yr^{-1}}\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">FilledEddyData &lt;-<span class="st"> </span>EProc<span class="op">$</span><span class="kw">sExportResults</span>()
uStarSuffixes &lt;-<span class="st"> </span><span class="kw">colnames</span>(EProc<span class="op">$</span><span class="kw">sGetUstarScenarios</span>())[<span class="op">-</span><span class="dv">1</span>]
<span class="co">#suffix &lt;- uStarSuffixes[2]</span>
GPPAggCO2 &lt;-<span class="st"> </span><span class="kw">sapply</span>( uStarSuffixes, <span class="cf">function</span>(suffix) {
    GPPHalfHour &lt;-<span class="st"> </span>FilledEddyData[[<span class="kw">paste0</span>(<span class="st">&quot;GPP_&quot;</span>,suffix,<span class="st">&quot;_f&quot;</span>)]]
    <span class="kw">mean</span>(GPPHalfHour, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)
})
molarMass &lt;-<span class="st"> </span><span class="fl">12.011</span>
GPPAgg &lt;-<span class="st"> </span>GPPAggCO2 <span class="op">*</span><span class="st"> </span><span class="fl">1e-6</span> <span class="op">*</span><span class="st"> </span>molarMass <span class="op">*</span><span class="st"> </span><span class="dv">3600</span><span class="op">*</span><span class="dv">24</span><span class="op">*</span><span class="fl">365.25</span>
<span class="kw">print</span>(GPPAgg)</code></pre></div>
<pre><code>##    uStar      U05      U50      U95 
## 1919.176 1897.384 1956.716 1898.528</code></pre>
<p>The difference between those aggregated values is a first estimate of uncertainty range in GPP due to uncertainty of the <span class="math inline">\(u_*\)</span> threshold.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(<span class="kw">max</span>(GPPAgg) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(GPPAgg)) <span class="op">/</span><span class="st"> </span><span class="kw">median</span>(GPPAgg) </code></pre></div>
<p>In this run of the example a relative error of about 3.1% is inferred.</p>
<p>For a better but more time consuming uncertainty estimate, specify a larger sample of <span class="math inline">\(u_*\)</span> threshold values, for each repeat the post-processing, and compute statistics from the larger sample of resulting GPP columns. This can be achieved by specifying a larger sequence of quantiles when calling <code>sEstimateUstarScenarios</code> in place of the command shown above.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">EProc<span class="op">$</span><span class="kw">sEstimateUstarScenarios</span>( 
  <span class="dt">nSample =</span> <span class="dv">200</span>, <span class="dt">probs =</span> <span class="kw">seq</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>,<span class="dt">length.out =</span> <span class="dv">39</span>) )</code></pre></div>
</div>
<div id="storing-the-results-in-a-csv-file" class="section level2">
<h2>Storing the results in a csv-file</h2>
<p>The results still reside inside the <code>sEddyProc</code> class. We first export them to an R Data.frame, append the columns to the original input data, and write this data.frame to text file in a temporary directory.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">FilledEddyData &lt;-<span class="st"> </span>EProc<span class="op">$</span><span class="kw">sExportResults</span>()
CombinedData &lt;-<span class="st"> </span><span class="kw">cbind</span>(EddyData, FilledEddyData)
<span class="kw">fWriteDataframeToFile</span>(CombinedData, <span class="st">'DE-Tha-Results.txt'</span>, <span class="dt">Dir =</span> <span class="kw">tempdir</span>())</code></pre></div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
